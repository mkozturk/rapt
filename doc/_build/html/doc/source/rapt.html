<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>rapt package &mdash; rapt 0.9 documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="rapt 0.9 documentation" href="../../index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">rapt 0.9 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">rapt package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-rapt.Adaptive">rapt.Adaptive module</a></li>
<li><a class="reference internal" href="#module-rapt.BounceCenter">rapt.BounceCenter module</a></li>
<li><a class="reference internal" href="#module-rapt.GuidingCenter">rapt.GuidingCenter module</a></li>
<li><a class="reference internal" href="#module-rapt.Particle">rapt.Particle module</a></li>
<li><a class="reference internal" href="#module-rapt.fieldline">rapt.fieldline module</a></li>
<li><a class="reference internal" href="#module-rapt.fields">rapt.fields module</a></li>
<li><a class="reference internal" href="#module-rapt.flutils">rapt.flutils module</a></li>
<li><a class="reference internal" href="#module-rapt.rcme">rapt.rcme module</a></li>
<li><a class="reference internal" href="#module-rapt.rkf">rapt.rkf module</a></li>
<li><a class="reference internal" href="#rapt-tricubic-module">rapt.tricubic module</a></li>
<li><a class="reference internal" href="#module-rapt.utils">rapt.utils module</a></li>
<li><a class="reference internal" href="#module-rapt">Module contents</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/doc/source/rapt.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="rapt-package">
<h1>rapt package<a class="headerlink" href="#rapt-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-rapt.Adaptive">
<span id="rapt-adaptive-module"></span><h2>rapt.Adaptive module<a class="headerlink" href="#module-rapt.Adaptive" title="Permalink to this headline">¶</a></h2>
<p>Adaptive class definition</p>
<dl class="docutils">
<dt>AUTHOR:</dt>
<dd><p class="first">Kaan Ozturk &lt;<a class="reference external" href="mailto:mkozturk&#37;&#52;&#48;yahoo&#46;com">mkozturk<span>&#64;</span>yahoo<span>&#46;</span>com</a>&gt;</p>
<p class="last">2016, Rice University</p>
</dd>
</dl>
<dl class="class">
<dt id="rapt.Adaptive.Adaptive">
<em class="property">class </em><code class="descclassname">rapt.Adaptive.</code><code class="descname">Adaptive</code><span class="sig-paren">(</span><em>pos=None</em>, <em>vel=None</em>, <em>t0=0</em>, <em>mass=None</em>, <em>charge=None</em>, <em>field=None</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Adaptive.Adaptive" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>A tracer that can switch between Particle and GuidingCenter modes depending
on local adiabaticity conditions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pos: list or array</strong></p>
<blockquote>
<div><p>The initial position (x,y,z) of the particle, in meters.</p>
</div></blockquote>
<p><strong>v: float</strong></p>
<blockquote>
<div><p>The initial speed of the particle, in m/s.</p>
</div></blockquote>
<p><strong>pa: float</strong></p>
<blockquote>
<div><p>The initial pitch angle, in degrees (not needed if ppar is given)</p>
</div></blockquote>
<p><strong>ppar: float</strong></p>
<blockquote>
<div><p>The initial parallel momentum, in kg m/s (not needed if pa is given)</p>
</div></blockquote>
<p><strong>t0: float</strong></p>
<blockquote>
<div><p>The time of simulation at the beginning (seconds), ignored for fields that do not depend on time.</p>
</div></blockquote>
<p><strong>mass: float</strong></p>
<blockquote>
<div><p>The mass of the particle, in kg.</p>
</div></blockquote>
<p><strong>charge: float</strong></p>
<blockquote>
<div><p>The charge of the particle, in Coulombs.</p>
</div></blockquote>
<p><strong>field: Field object</strong></p>
<blockquote class="last">
<div><p>The field object that provides electric and magnetic field vectors and related quantities.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../../particle.html#module-rapt.Particle" title="rapt.Particle"><code class="xref py py-obj docutils literal"><span class="pre">rapt.Particle</span></code></a>, <a class="reference internal" href="../../guidingcenter.html#module-rapt.GuidingCenter" title="rapt.GuidingCenter"><code class="xref py py-obj docutils literal"><span class="pre">rapt.GuidingCenter</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>An <cite>Adaptive</cite> object is a wrapper around <cite>Particle</cite> and <cite>GuidingCenter</cite>
objects. It s initialized as a <cite>Particle</cite>. Initially, and after every
integration step, the adiabaticity condition is checked. If it is satisfied
and the current tracer is a <cite>Particle</cite>, a <cite>GuidingCenter</cite> is initialized
with the last state. If the adiabaticity condition is violated while
the current tracer is a <cite>GuidingCenter</cite>, a <cite>Particle</cite> is initialized with
the last state. These different tracer objects are stored in the <cite>trajlist</cite>
attribute, and the data is accessed with the getter members <cite>gett</cite>,
<cite>getx</cite>, etc. seamlessly.</p>
<p>The <cite>Adaptive</cite> tracer sets the <cite>check_adiabaticity</cite> attributes of <cite>Particle</cite>
and <cite>GuidingCenter</cite> objects it generates. It detects the switching points by
catching the exceptions <cite>rapt.Adiabatic</cite> and <cite>rapt.NonAdiabatic</cite>.</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="93%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>tcur</td>
<td>(float) The current time value (seconds), updated after every integration step.</td>
</tr>
<tr class="row-even"><td>trajlist</td>
<td>(list) The list that stores <cite>Particle</cite> and <cite>GuidingCenter</cite> objects that comprise the whole trajectory.</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="rapt.Adaptive.Adaptive.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>delta</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Adaptive.Adaptive.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advance the tracer position and the relevant momentum for a given duration.</p>
<p>The trajectory is initialized at the latest state of the current tracer
and integrated for an additional <cite>delta</cite> seconds. Uses the settings
specific to the current tracer.</p>
<p>This method can be called many times.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>delta</strong> : float</p>
<blockquote class="last">
<div><p>The number of seconds to advance the trajectory.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rapt.Adaptive.Adaptive.getke">
<code class="descname">getke</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Adaptive.Adaptive.getke" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of kinetic energy values (Joule) along the
trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Adaptive.Adaptive.getphi">
<code class="descname">getphi</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Adaptive.Adaptive.getphi" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of polar angle coordinate (radians) along the
trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Adaptive.Adaptive.getr">
<code class="descname">getr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Adaptive.Adaptive.getr" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of radial distance along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Adaptive.Adaptive.gett">
<code class="descname">gett</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Adaptive.Adaptive.gett" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of time values along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Adaptive.Adaptive.gettheta">
<code class="descname">gettheta</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Adaptive.Adaptive.gettheta" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of azimuthal angle coordinate (radians) along the
trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Adaptive.Adaptive.getx">
<code class="descname">getx</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Adaptive.Adaptive.getx" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of x-coordinate values along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Adaptive.Adaptive.gety">
<code class="descname">gety</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Adaptive.Adaptive.gety" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of y-coordinate values along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Adaptive.Adaptive.getz">
<code class="descname">getz</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Adaptive.Adaptive.getz" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of z-coordinate values along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Adaptive.Adaptive.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Adaptive.Adaptive.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the object from disk.</p>
<p>Uses the built-in pickle module. All existing data is replaced
with the stored data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote class="last">
<div><p>The name of the file where the object is stored.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rapt.Adaptive.Adaptive.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Adaptive.Adaptive.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the object on disk.</p>
<p>Uses the built-in pickle module.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote class="last">
<div><p>The name of the file to store. If file exists, it will be overwritten.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rapt.Adaptive.Adaptive.setke">
<code class="descname">setke</code><span class="sig-paren">(</span><em>ke</em>, <em>unit='ev'</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Adaptive.Adaptive.setke" title="Permalink to this definition">¶</a></dt>
<dd><p>Scale the velocity vector with the speed corresponding to the given kinetic energy.
Reinitializes the object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>ke</strong> : float</p>
<blockquote>
<div><p>The kinetic energy of the particle (eV by default). Can be relativistic.</p>
</div></blockquote>
<p><strong>unit</strong> : str, optional</p>
<blockquote class="last">
<div><p>The unit of the energy. If &#8220;ev&#8221;, electron volts, otherwise Joule.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rapt.Adaptive.Adaptive.setpa">
<code class="descname">setpa</code><span class="sig-paren">(</span><em>pa</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Adaptive.Adaptive.setpa" title="Permalink to this definition">¶</a></dt>
<dd><p>Reinitialize the object with the given pitch angle (in degrees).</p>
<p>Modifies the velocity vector while keeping the energy constant so that
the particle&#8217;s pitch angle (angle between the velocity and magnetic field
vectors) is <cite>pa</cite> degrees. Previous data is lost.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pa</strong> : float</p>
<blockquote class="last">
<div><p>The new pitch angle in degrees.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-rapt.BounceCenter">
<span id="rapt-bouncecenter-module"></span><h2>rapt.BounceCenter module<a class="headerlink" href="#module-rapt.BounceCenter" title="Permalink to this headline">¶</a></h2>
<p>BounceCenter class definition</p>
<dl class="docutils">
<dt>AUTHOR:</dt>
<dd><p class="first">Kaan Ozturk &lt;<a class="reference external" href="mailto:mkozturk&#37;&#52;&#48;yahoo&#46;com">mkozturk<span>&#64;</span>yahoo<span>&#46;</span>com</a>&gt;</p>
<p class="last">2016, Rice University</p>
</dd>
</dl>
<dl class="class">
<dt id="rapt.BounceCenter.BounceCenter">
<em class="property">class </em><code class="descclassname">rapt.BounceCenter.</code><code class="descname">BounceCenter</code><span class="sig-paren">(</span><em>pos=[]</em>, <em>v=None</em>, <em>t0=0</em>, <em>pa=None</em>, <em>mass=None</em>, <em>charge=None</em>, <em>field=None</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.BounceCenter.BounceCenter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Bounce-averaged tracer mode. Works only with static magnetic fields.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pos: list or array</strong></p>
<blockquote>
<div><p>The initial position (x,y,z) of the particle, in meters.</p>
</div></blockquote>
<p><strong>v: float</strong></p>
<blockquote>
<div><p>The initial speed of the particle, in m/s.</p>
</div></blockquote>
<p><strong>t0: float</strong></p>
<blockquote>
<div><p>The time of simulation at the beginning (seconds).</p>
</div></blockquote>
<p><strong>pa: float</strong></p>
<blockquote>
<div><p>The initial pitch angle, in degrees</p>
</div></blockquote>
<p><strong>mass: float</strong></p>
<blockquote>
<div><p>The mass of the particle, in kg.</p>
</div></blockquote>
<p><strong>charge: float</strong></p>
<blockquote>
<div><p>The charge of the particle, in Coulombs.</p>
</div></blockquote>
<p><strong>field: Field object</strong></p>
<blockquote class="last">
<div><p>The field object that provides electric and magnetic field vectors and
related quantities.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../../particle.html#module-rapt.Particle" title="rapt.Particle"><code class="xref py py-obj docutils literal"><span class="pre">rapt.Particle</span></code></a>, <a class="reference internal" href="../../guidingcenter.html#module-rapt.GuidingCenter" title="rapt.GuidingCenter"><code class="xref py py-obj docutils literal"><span class="pre">rapt.GuidingCenter</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>The bounce-averaged motion of a particle is the pure drift motion resulting
from averaging out the field-aligned longitudinal motion. This averaging
requires that the change in the field from one bounce to the next is small,
i.e., the first and the second invariants exist.</p>
<p>Theoretically, bounce-averaged drift should be the most efficient mode of
tracing, if the adiabaticity conditions are satisfied. However, each
evaluation of the equation of motion involves determining the gradient of
the second invariant and of the half-bounce path length, comprising 5 traces
of field lines. Because the ode-solver evaluates the eom many times within 
one integration step, the computation is very costly even for moderate error
tolerances.</p>
<p>In the cases we tried, following a <cite>GuidingCenter</cite> is faster than following a
<cite>BounceCenter</cite>, even for low-energy electrons. Because of this, we did not
extend BounceCenter to work with electric and nonstatic magnetic fields, and
did not extend <cite>Adaptive&#8217; to include a `BounceCenter</cite> mode.</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="91%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>trajectory</td>
<td>(n-by-4 array) The trajectory array, each row in the form (t, x, y, z).</td>
</tr>
<tr class="row-even"><td>isequatorial</td>
<td>(bool) If True, uses gradient and inertial drift velocities to advance the solution. For particles with no longitudinal motion.</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="rapt.BounceCenter.BounceCenter.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>delta</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.BounceCenter.BounceCenter.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advance the particle position for the given duration.</p>
<p>The trajectory is initialized at the latest state of the object
and integrated for an additional <cite>delta</cite> seconds. Uses the 
<cite>scipy.integrate.ode</cite> class with <cite>&#8220;dopri5&#8221;</cite> solver.</p>
<p>This method can be called many times.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>delta</strong> : float</p>
<blockquote class="last">
<div><p>The number of seconds to advance the trajectory.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The explicit runge-kutta method of order 4(5) due to Dormand &amp; Prince
with stepsize control is used to solve for the motion. The relative 
tolerance <cite>rtol</cite> and the absolute tolerance <cite>atol</cite> of the solver can be
set with <cite>rapt.params[&#8220;solvertolerances&#8221;] = (rtol, atol)</cite></p>
</dd></dl>

<dl class="method">
<dt id="rapt.BounceCenter.BounceCenter.getB">
<code class="descname">getB</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.BounceCenter.BounceCenter.getB" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of total magnetic field strength values along the 
trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.BounceCenter.BounceCenter.getphi">
<code class="descname">getphi</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.BounceCenter.BounceCenter.getphi" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of polar angle coordinate (radians) along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.BounceCenter.BounceCenter.getr">
<code class="descname">getr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.BounceCenter.BounceCenter.getr" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of radial distance along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.BounceCenter.BounceCenter.gett">
<code class="descname">gett</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.BounceCenter.BounceCenter.gett" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of time values along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.BounceCenter.BounceCenter.gettheta">
<code class="descname">gettheta</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.BounceCenter.BounceCenter.gettheta" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of azimuthal angle coordinate (radians) along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.BounceCenter.BounceCenter.getx">
<code class="descname">getx</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.BounceCenter.BounceCenter.getx" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of x-coordinate values along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.BounceCenter.BounceCenter.gety">
<code class="descname">gety</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.BounceCenter.BounceCenter.gety" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of x-coordinate values along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.BounceCenter.BounceCenter.getz">
<code class="descname">getz</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.BounceCenter.BounceCenter.getz" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of x-coordinate values along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.BounceCenter.BounceCenter.setpa">
<code class="descname">setpa</code><span class="sig-paren">(</span><em>pa</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.BounceCenter.BounceCenter.setpa" title="Permalink to this definition">¶</a></dt>
<dd><p>Reinitialize the object with the given pitch angle (in degrees).</p>
<p>Modifies the velocity vector while keeping the energy constant so that
the particle&#8217;s pitch angle (angle between the velocity and magnetic field
vectors) is <cite>pa</cite> degrees. Runs the <cite>__init__</cite> method, so any existing data
will be lost.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pa</strong> : float</p>
<blockquote class="last">
<div><p>The new pitch angle in degrees.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-rapt.GuidingCenter">
<span id="rapt-guidingcenter-module"></span><h2>rapt.GuidingCenter module<a class="headerlink" href="#module-rapt.GuidingCenter" title="Permalink to this headline">¶</a></h2>
<p>GuidingCenter class definition</p>
<dl class="docutils">
<dt>AUTHOR:</dt>
<dd><p class="first">Kaan Ozturk &lt;<a class="reference external" href="mailto:mkozturk&#37;&#52;&#48;yahoo&#46;com">mkozturk<span>&#64;</span>yahoo<span>&#46;</span>com</a>&gt;</p>
<p class="last">2016, Rice University</p>
</dd>
</dl>
<dl class="class">
<dt id="rapt.GuidingCenter.GuidingCenter">
<em class="property">class </em><code class="descclassname">rapt.GuidingCenter.</code><code class="descname">GuidingCenter</code><span class="sig-paren">(</span><em>pos=[]</em>, <em>v=0</em>, <em>pa=None</em>, <em>ppar=None</em>, <em>t0=0</em>, <em>mass=None</em>, <em>charge=None</em>, <em>field=None</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.GuidingCenter.GuidingCenter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>A GuidingCenter of a charged particle, moving under the influence of given 
electric and magnetic fields.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pos: list or array</strong></p>
<blockquote>
<div><p>The initial position (x,y,z) of the particle, in meters.</p>
</div></blockquote>
<p><strong>v: float</strong></p>
<blockquote>
<div><p>The initial speed of the particle, in m/s.</p>
</div></blockquote>
<p><strong>pa: float</strong></p>
<blockquote>
<div><p>The initial pitch angle, in degrees (not needed if ppar is given)</p>
</div></blockquote>
<p><strong>ppar: float</strong></p>
<blockquote>
<div><p>The initial parallel momentum, in kg m/s (not needed if pa is given)</p>
</div></blockquote>
<p><strong>t0: float</strong></p>
<blockquote>
<div><p>The time of simulation at the beginning (seconds), ignored for fields that do not depend on time.</p>
</div></blockquote>
<p><strong>mass: float</strong></p>
<blockquote>
<div><p>The mass of the particle, in kg.</p>
</div></blockquote>
<p><strong>charge: float</strong></p>
<blockquote>
<div><p>The charge of the particle, in Coulombs.</p>
</div></blockquote>
<p><strong>field: Field object</strong></p>
<blockquote class="last">
<div><p>The field object that provides electric and magnetic field vectors and related quantities.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../../particle.html#module-rapt.Particle" title="rapt.Particle"><code class="xref py py-obj docutils literal"><span class="pre">rapt.Particle</span></code></a>, <a class="reference internal" href="#module-rapt.Adaptive" title="rapt.Adaptive"><code class="xref py py-obj docutils literal"><span class="pre">rapt.Adaptive</span></code></a></p>
</div>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>tcur</td>
<td>(float) The current time value (seconds), updated after every integration step.</td>
</tr>
<tr class="row-even"><td>trajectory</td>
<td>(n-by-5 array) The trajectory array, each row in the form (t, x, y, z, ppar).</td>
</tr>
<tr class="row-odd"><td>check_adiabaticity</td>
<td>(bool) If True, checks for the adiabaticity condition after every integration step.</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="rapt.GuidingCenter.GuidingCenter.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>delta</em>, <em>eom='TaoChanBrizardEOM'</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.GuidingCenter.GuidingCenter.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advance the particle position and parallel momentum for a given duration.</p>
<p>The trajectory is initialized at the latest state of the <cite>GuidingCenter</cite>
and integrated for an additional <cite>delta</cite> seconds. Uses the 
<cite>scipy.integrate.ode</cite> class with <cite>&#8220;dopri5&#8221;</cite> solver.</p>
<p>This method can be called many times.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>delta</strong> : float</p>
<blockquote>
<div><p>The number of seconds to advance the trajectory.</p>
</div></blockquote>
<p><strong>eom</strong> : {&#8216;TaoChanBrizardEOM&#8217;, &#8216;BrizardChanEOM, &#8216;NorthropTellerEOM&#8217;}</p>
<blockquote>
<div><p>The equation of motion that is solved.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>NonAdiabatic</strong></p>
<blockquote class="last">
<div><p>Only if the <cite>check_adiabaticity</cite> attribute is set to True.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Assuming that the magnetic moment is a constant of motion, and averaging
out the gyrophase, reduces the number of dynamic variables to 4.</p>
<p>Despite their prevalence in textbooks, Northrop-Teller equations are
not accurate enough. The equations by Tao, Chan &amp; Brizard are designed
to preserve the phase-space volume, and give more accurate results than
Northrop-Teller equations.</p>
<p>Neither Northrop-Teller (as implemented here), nor the Chan-Brizard
equations are suitable to use with electric fields or with time-varying
magnetic fields. Tao-Chan-Brizard equations must be used.</p>
<p>Tao-Chan-Brizard EOM (the default setting) reduces to Brizard-Chan EOM 
under static conditions, with little computational overhead.</p>
<p>The explicit runge-kutta method of order 4(5) due to Dormand &amp; Prince
with stepsize control is used to solve for the motion. The relative 
tolerance <cite>rtol</cite> and the absolute tolerance <cite>atol</cite> of the solver can be
set with <cite>rapt.params[&#8220;solvertolerances&#8221;] = (rtol, atol)</cite></p>
</dd></dl>

<dl class="method">
<dt id="rapt.GuidingCenter.GuidingCenter.bounceperiod">
<code class="descname">bounceperiod</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.GuidingCenter.GuidingCenter.bounceperiod" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the bounce period at the current position.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.GuidingCenter.GuidingCenter.cycper">
<code class="descname">cycper</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.GuidingCenter.GuidingCenter.cycper" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the cyclotron period value at the final position.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.GuidingCenter.GuidingCenter.cycrad">
<code class="descname">cycrad</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.GuidingCenter.GuidingCenter.cycrad" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the cyclotron radius value at the final position.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.GuidingCenter.GuidingCenter.getB">
<code class="descname">getB</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.GuidingCenter.GuidingCenter.getB" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of total magnetic field strength values along the 
trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.GuidingCenter.GuidingCenter.getBm">
<code class="descname">getBm</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.GuidingCenter.GuidingCenter.getBm" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an array of mirror field values at each trajectory point.</p>
<p>Defined using the conservation of magnetic moment.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.GuidingCenter.GuidingCenter.geteye">
<code class="descname">geteye</code><span class="sig-paren">(</span><em>step=1</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.GuidingCenter.GuidingCenter.geteye" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of (time,second invariant) pairs along the 
guiding-center trajectory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>step</strong> : int, optional</p>
<blockquote class="last">
<div><p>Take every <cite>step</cite> values in the trajectory.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rapt.GuidingCenter.GuidingCenter.getgamma">
<code class="descname">getgamma</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.GuidingCenter.GuidingCenter.getgamma" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of relativistic factor values along the trajectory.</p>
<p>The relativistic factor is defined as <span class="math">\(\gamma = \sqrt{1 + 2\mu B / (mc^2) + (p_{||}/mc)^2}\)</span></p>
</dd></dl>

<dl class="method">
<dt id="rapt.GuidingCenter.GuidingCenter.getke">
<code class="descname">getke</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.GuidingCenter.GuidingCenter.getke" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of kinetic energy values (Joule) along the
trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.GuidingCenter.GuidingCenter.getp">
<code class="descname">getp</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.GuidingCenter.GuidingCenter.getp" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of total momentum values along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.GuidingCenter.GuidingCenter.getphi">
<code class="descname">getphi</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.GuidingCenter.GuidingCenter.getphi" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of polar angle coordinate (radians) along the 
trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.GuidingCenter.GuidingCenter.getpp">
<code class="descname">getpp</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.GuidingCenter.GuidingCenter.getpp" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of parallel momentum values along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.GuidingCenter.GuidingCenter.getr">
<code class="descname">getr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.GuidingCenter.GuidingCenter.getr" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of radial distance along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.GuidingCenter.GuidingCenter.gett">
<code class="descname">gett</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.GuidingCenter.GuidingCenter.gett" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of time values along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.GuidingCenter.GuidingCenter.gettheta">
<code class="descname">gettheta</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.GuidingCenter.GuidingCenter.gettheta" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of azimuthal angle coordinate (radians) along the
trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.GuidingCenter.GuidingCenter.getv">
<code class="descname">getv</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.GuidingCenter.GuidingCenter.getv" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of particle speed values along the guiding-center trajectories.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.GuidingCenter.GuidingCenter.getx">
<code class="descname">getx</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.GuidingCenter.GuidingCenter.getx" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of x-coordinate values along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.GuidingCenter.GuidingCenter.gety">
<code class="descname">gety</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.GuidingCenter.GuidingCenter.gety" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of y-coordinate values along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.GuidingCenter.GuidingCenter.getz">
<code class="descname">getz</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.GuidingCenter.GuidingCenter.getz" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of z-coordinate values along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.GuidingCenter.GuidingCenter.init">
<code class="descname">init</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.GuidingCenter.GuidingCenter.init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a Particle using the state of another Particle or GuidingCenter object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>p</strong> : Particle or GuidingCenter object.</p>
<blockquote class="last">
<div><p>The object that is used to initialize the current GuidingCenter.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Takes the last state (position and momentum) of the given <cite>Particle</cite>
or <cite>GuidingCenter</cite>, sets the initial conditions of self to match them,
and runs <cite>__init__</cite> again. Therefore, all existing data is erased.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.GuidingCenter.GuidingCenter.isadiabatic">
<code class="descname">isadiabatic</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.GuidingCenter.GuidingCenter.isadiabatic" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Check if the motion is adiabatic at the current location.</p>
<p>The adiabaticity condition is defined as</p>
<div class="math">
\[\]</div>
</div></blockquote>
<p>ho_c / L &lt; epsilon_s</p>
<blockquote>
<div><blockquote>
<div>au_c / T &lt; epsilon_t</div></blockquote>
<p>where :math: `</p>
</div></blockquote>
<dl class="docutils">
<dt>ho_c` is the cyclotron radius, :math: ` au_c` is the </dt>
<dd>cyclotron period, L is the field length scale, T is the field time scale,
and :math: <cite>epsilon_s, epsilon_t</cite> are thresholds for adiabaticity.
The length scales are provided by the field object, and threshold 
parameters set with <cite>rapt.params[&#8220;epss&#8221;]</cite> and <cite>rapt.params[&#8220;epst&#8221;]</cite>, 
respectively.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">bool</p>
<blockquote class="last">
<div><blockquote>
<div><p>True if the particle&#8217;s motion satisfies the adiabaticity conditions</p>
</div></blockquote>
<p>at the present location, False otherwise.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rapt.GuidingCenter.GuidingCenter.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.GuidingCenter.GuidingCenter.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the object from disk.</p>
<p>Uses the built-in pickle module. All existing data is replaced
with the stored data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote class="last">
<div><p>The name of the file where the object is stored.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rapt.GuidingCenter.GuidingCenter.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.GuidingCenter.GuidingCenter.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the object on disk.</p>
<p>Uses the built-in pickle module.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote class="last">
<div><p>The name of the file to store. If file exists, it will be overwritten.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rapt.GuidingCenter.GuidingCenter.setke">
<code class="descname">setke</code><span class="sig-paren">(</span><em>ke</em>, <em>unit='ev'</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.GuidingCenter.GuidingCenter.setke" title="Permalink to this definition">¶</a></dt>
<dd><p>Scale the velocity vector with the speed corresponding to the given kinetic energy.
Reinitializes the object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>ke</strong> : float</p>
<blockquote>
<div><p>The kinetic energy of the particle (eV by default). Can be relativistic.</p>
</div></blockquote>
<p><strong>unit</strong> : str, optional</p>
<blockquote class="last">
<div><p>The unit of the energy. If &#8220;ev&#8221;, electron volts, otherwise Joule.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rapt.GuidingCenter.GuidingCenter.setpa">
<code class="descname">setpa</code><span class="sig-paren">(</span><em>pa</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.GuidingCenter.GuidingCenter.setpa" title="Permalink to this definition">¶</a></dt>
<dd><p>Reinitialize the object with the given pitch angle (in degrees).</p>
<p>Modifies the velocity vector while keeping the energy constant so that
the particle&#8217;s pitch angle (angle between the velocity and magnetic field
vectors) is <cite>pa</cite> degrees. Runs the <cite>__init__</cite> method, so any existing data
will be lost.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pa</strong> : float</p>
<blockquote class="last">
<div><p>The new pitch angle in degrees.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-rapt.Particle">
<span id="rapt-particle-module"></span><h2>rapt.Particle module<a class="headerlink" href="#module-rapt.Particle" title="Permalink to this headline">¶</a></h2>
<p>Particle class definition</p>
<dl class="docutils">
<dt>AUTHOR:</dt>
<dd><p class="first">Kaan Ozturk &lt;<a class="reference external" href="mailto:mkozturk&#37;&#52;&#48;yahoo&#46;com">mkozturk<span>&#64;</span>yahoo<span>&#46;</span>com</a>&gt;</p>
<p class="last">2016, Rice University</p>
</dd>
</dl>
<dl class="class">
<dt id="rapt.Particle.Particle">
<em class="property">class </em><code class="descclassname">rapt.Particle.</code><code class="descname">Particle</code><span class="sig-paren">(</span><em>pos=[]</em>, <em>vel=[]</em>, <em>t0=0</em>, <em>mass=None</em>, <em>charge=None</em>, <em>field=None</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>A classical particle (i.e., nonquantum, but relativistic), such as an electron or a proton,
moving under the influence of given electric and magnetic fields.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pos: list or array</strong></p>
<blockquote>
<div><p>The initial position (x,y,z) of the particle, in meters.</p>
</div></blockquote>
<p><strong>vel: list or array</strong></p>
<blockquote>
<div><p>The initial velocity (vx, vy, vz) of the particle, in m/s.</p>
</div></blockquote>
<p><strong>t0: float</strong></p>
<blockquote>
<div><p>The time of simulation at the beginning (seconds), ignored for fields that do not depend on time.</p>
</div></blockquote>
<p><strong>mass: float</strong></p>
<blockquote>
<div><p>The mass of the particle, in kg.</p>
</div></blockquote>
<p><strong>charge: float</strong></p>
<blockquote>
<div><p>The charge of the particle, in Coulombs.</p>
</div></blockquote>
<p><strong>field: Field object</strong></p>
<blockquote class="last">
<div><p>The field object that provides electric and magnetic field vectors and related quantities.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../../guidingcenter.html#module-rapt.GuidingCenter" title="rapt.GuidingCenter"><code class="xref py py-obj docutils literal"><span class="pre">rapt.GuidingCenter</span></code></a>, <a class="reference internal" href="#module-rapt.Adaptive" title="rapt.Adaptive"><code class="xref py py-obj docutils literal"><span class="pre">rapt.Adaptive</span></code></a></p>
</div>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>tcur</td>
<td>(float) The current time value (seconds), updated after every integration step.</td>
</tr>
<tr class="row-even"><td>trajectory</td>
<td>(n-by-7 array) The trajectory array, each row in the form (t, x, y, z, px, py, pz).</td>
</tr>
<tr class="row-odd"><td>check_adiabaticity</td>
<td>(bool) If True, checks for the adiabaticity condition after every integration step.</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="rapt.Particle.Particle.advance">
<code class="descname">advance</code><span class="sig-paren">(</span><em>delta</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.advance" title="Permalink to this definition">¶</a></dt>
<dd><p>Advance the particle position and momentum for a given duration.</p>
<p>The trajectory is initialized at the latest state of the particle and 
integrated for an additional <cite>delta</cite> seconds. Uses the <cite>scipy.integrate.ode</cite>
class with <cite>&#8220;dop853&#8221;</cite> solver.</p>
<p>This method can be called many times.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>delta</strong> : float</p>
<blockquote>
<div><p>The number of seconds to advance the trajectory.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>Adiabatic</strong></p>
<blockquote class="last">
<div><p>Only if the <cite>check_adiabaticity</cite> attribute is set to True.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The particle is subject to the Newton-Lorentz equation of motion.</p>
<div class="math">
\[ \begin{align}\begin{aligned}\begin{split}\frac{\mathrm{d}\vec{x}}{\mathrm{d}t} = \frac{\vec{p}}{\gamma m} \\\end{split}\\\frac{\mathrm{d}\vec{p}}{\mathrm{d}t} = q\vec{E} + q\vec{v}\times\vec{B}\end{aligned}\end{align} \]</div>
<p>where <span class="math">\(\gamma = \sqrt{1 + (|\vec{p}|/mc)^2}\)</span> is the relativistic factor.</p>
<p>The explicit runge-kutta method of order 8(5,3) due to Dormand &amp; Prince
with stepsize control is used to solve for the motion. The relative 
tolerance <cite>rtol</cite> and the absolute tolerance <cite>atol</cite> of the solver can be
set with: <cite>rapt.params[&#8220;solvertolerances&#8221;] = (rtol, atol)</cite></p>
<p>The <cite>beta</cite> parameter to the <cite>scipy.integrate.ode.setintegrator</cite> method
serves to stabilize the solution in gridded fields.</p>
</dd></dl>

<dl class="attribute">
<dt id="rapt.Particle.Particle.check_adiabaticity">
<code class="descname">check_adiabaticity</code><em class="property"> = None</em><a class="headerlink" href="#rapt.Particle.Particle.check_adiabaticity" title="Permalink to this definition">¶</a></dt>
<dd><p>If True, checks for the adiabaticity condition after every integration step.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Particle.Particle.cycper">
<code class="descname">cycper</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.cycper" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the cyclotron period value at the final position.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Particle.Particle.cycrad">
<code class="descname">cycrad</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.cycrad" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the cyclotron radius value at the final position.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Particle.Particle.getB">
<code class="descname">getB</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.getB" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of total magnetic field strength values along the 
trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Particle.Particle.getgamma">
<code class="descname">getgamma</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.getgamma" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of relativistic factor values along the trajectory.</p>
<p>The relativistic factor is defined as <span class="math">\(\gamma = \sqrt{1 + (p/mc)^2}\)</span></p>
</dd></dl>

<dl class="method">
<dt id="rapt.Particle.Particle.getke">
<code class="descname">getke</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.getke" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of kinetic energy values (Joule) along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Particle.Particle.getp">
<code class="descname">getp</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.getp" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of total momentum values along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Particle.Particle.getphi">
<code class="descname">getphi</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.getphi" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of polar angle coordinate (radians) along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Particle.Particle.getpx">
<code class="descname">getpx</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.getpx" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of the x-component of the momentum along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Particle.Particle.getpy">
<code class="descname">getpy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.getpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of the y-component of the momentum along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Particle.Particle.getpz">
<code class="descname">getpz</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.getpz" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of the z-component of the momentum along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Particle.Particle.getr">
<code class="descname">getr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.getr" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of radial distance along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Particle.Particle.gett">
<code class="descname">gett</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.gett" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of time values along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Particle.Particle.gettheta">
<code class="descname">gettheta</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.gettheta" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of azimuthal angle coordinate (radians) along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Particle.Particle.getv">
<code class="descname">getv</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.getv" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of the particle speed along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Particle.Particle.getvx">
<code class="descname">getvx</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.getvx" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of the x-component of the velocity along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Particle.Particle.getvy">
<code class="descname">getvy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.getvy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of the y-component of the velocity along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Particle.Particle.getvz">
<code class="descname">getvz</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.getvz" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of the z-component of the velocity along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Particle.Particle.getx">
<code class="descname">getx</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.getx" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of x-coordinate values along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Particle.Particle.gety">
<code class="descname">gety</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.gety" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of y-coordinate values along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Particle.Particle.getz">
<code class="descname">getz</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.getz" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of z-coordinate values along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Particle.Particle.guidingcenter">
<code class="descname">guidingcenter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.guidingcenter" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 2-d array of guiding center positions corresponding to particle positions.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Particle.Particle.init">
<code class="descname">init</code><span class="sig-paren">(</span><em>p</em>, <em>gyrophase=0</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a Particle using the state of another Particle or GuidingCenter object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>p</strong> : Particle or GuidingCenter object.</p>
<blockquote>
<div><p>The object that is used to initialize the current Particle.</p>
</div></blockquote>
<p><strong>gyrophase</strong> : float, optional.</p>
<blockquote class="last">
<div><p>The phase angle of the gyromotion, if initializing with a GuidingCenter.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#rapt.utils.GCtoFP" title="rapt.utils.GCtoFP"><code class="xref py py-obj docutils literal"><span class="pre">rapt.utils.GCtoFP</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>Takes the last state (position and momentum) of the given <cite>Particle</cite>
or <cite>GuidingCenter</cite>, sets the initial conditions of self to match them,
and runs <cite>__init__</cite> again. Therefore, all existing data is erased.</p>
<p>Initialization from a <cite>GuidingCenter</cite> involves adding the gyroradius vector
to the position. This process introduces an arbitrariness in the phase angle.
This arbitrariness cannot be avoided because it is inherent in the definition
of the guiding center. The optional <cite>gyrophase</cite> parameter allows the user to 
set it to different values, e.g. to produce an ensemble of particles.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Particle.Particle.isadiabatic">
<code class="descname">isadiabatic</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.isadiabatic" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the particle motion is adiabatic at the current location.</p>
<p>The adiabaticity condition is defined as</p>
<div class="math">
\[ \begin{align}\begin{aligned}\rho_c / L &lt; \epsilon_s\\\tau_c / T &lt; \epsilon_t\end{aligned}\end{align} \]</div>
<p>where <span class="math">\(\rho_c\)</span> is the cyclotron radius, <span class="math">\(\tau_c\)</span> is the 
cyclotron period, L is the field length scale, T is the field time scale,
and <span class="math">\(\epsilon_s, \epsilon_t\)</span> are user-supplied thresholds for adiabaticity.
The length scales are provided by the field object, and threshold 
parameters set with <cite>rapt.params[&#8220;epss&#8221;]</cite> and <cite>rapt.params[&#8220;epst&#8221;]</cite>, 
respectively.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">bool</p>
<blockquote>
<div><p>True if the particle&#8217;s motion satisfies the adiabaticity conditions</p>
</div></blockquote>
<p class="last">at the present location, False otherwise.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rapt.Particle.Particle.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the object from disk.</p>
<p>Uses the built-in pickle module. All existing Particle data is replaced
with the stored data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote class="last">
<div><p>The name of the file where the object is stored.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rapt.Particle.Particle.mu">
<code class="descname">mu</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.mu" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1-d array of the magnetic moment values along the trajectory.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.Particle.Particle.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the object on disk.</p>
<p>Uses the built-in pickle module.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote class="last">
<div><p>The name of the file to store. If file exists, it will be overwritten.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rapt.Particle.Particle.setke">
<code class="descname">setke</code><span class="sig-paren">(</span><em>ke</em>, <em>unit='ev'</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.setke" title="Permalink to this definition">¶</a></dt>
<dd><p>Scale the velocity vector with the speed corresponding to the given kinetic energy.
Reinitializes the object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>ke</strong> : float</p>
<blockquote>
<div><p>The kinetic energy of the particle (eV by default). Can be relativistic.</p>
</div></blockquote>
<p><strong>unit</strong> : str, optional</p>
<blockquote class="last">
<div><p>The unit of the energy. If &#8220;ev&#8221;, electron volts, otherwise Joule.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rapt.Particle.Particle.setpa">
<code class="descname">setpa</code><span class="sig-paren">(</span><em>pa</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.Particle.Particle.setpa" title="Permalink to this definition">¶</a></dt>
<dd><p>Reinitialize the object with the given pitch angle (in degrees).</p>
<p>Modifies the velocity vector while keeping the energy constant so that
the particle&#8217;s pitch angle (angle between the velocity and magnetic field
vectors) is <cite>pa</cite> degrees. Runs the <cite>__init__</cite> method, so any existing data
will be lost.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pa</strong> : float</p>
<blockquote class="last">
<div><p>The new pitch angle in degrees.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rapt.Particle.Particle.tcur">
<code class="descname">tcur</code><em class="property"> = None</em><a class="headerlink" href="#rapt.Particle.Particle.tcur" title="Permalink to this definition">¶</a></dt>
<dd><p>The current time value (seconds), updated after every integration step.</p>
</dd></dl>

<dl class="attribute">
<dt id="rapt.Particle.Particle.trajectory">
<code class="descname">trajectory</code><em class="property"> = None</em><a class="headerlink" href="#rapt.Particle.Particle.trajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>The trajectory array, each row in the form (t, x, y, z, px, py, pz).</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-rapt.fieldline">
<span id="rapt-fieldline-module"></span><h2>rapt.fieldline module<a class="headerlink" href="#module-rapt.fieldline" title="Permalink to this headline">¶</a></h2>
<p>Created on Tue Sep 22 12:54:01 2015</p>
<p>&#64;author: kaan</p>
<dl class="class">
<dt id="rapt.fieldline.Fieldline">
<em class="property">class </em><code class="descclassname">rapt.fieldline.</code><code class="descname">Fieldline</code><span class="sig-paren">(</span><em>tpos</em>, <em>field</em>, <em>ds=0</em>, <em>stopcond=None</em>, <em>Bmin=None</em>, <em>Bmax=None</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fieldline.Fieldline" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="rapt.fieldline.Fieldline.getB">
<code class="descname">getB</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fieldline.Fieldline.getB" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="rapt.fieldline.Fieldline.getphi">
<code class="descname">getphi</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fieldline.Fieldline.getphi" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="rapt.fieldline.Fieldline.getr">
<code class="descname">getr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fieldline.Fieldline.getr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="rapt.fieldline.Fieldline.gets">
<code class="descname">gets</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fieldline.Fieldline.gets" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="rapt.fieldline.Fieldline.gettheta">
<code class="descname">gettheta</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fieldline.Fieldline.gettheta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="rapt.fieldline.Fieldline.getx">
<code class="descname">getx</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fieldline.Fieldline.getx" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="rapt.fieldline.Fieldline.gety">
<code class="descname">gety</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fieldline.Fieldline.gety" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="rapt.fieldline.Fieldline.getz">
<code class="descname">getz</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fieldline.Fieldline.getz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="rapt.fieldline.Fieldline.reset">
<code class="descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fieldline.Fieldline.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="rapt.fieldline.Fieldline.trace">
<code class="descname">trace</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fieldline.Fieldline.trace" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-rapt.fields">
<span id="rapt-fields-module"></span><h2>rapt.fields module<a class="headerlink" href="#module-rapt.fields" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="rapt.fields.DoubleDipole">
<em class="property">class </em><code class="descclassname">rapt.fields.</code><code class="descname">DoubleDipole</code><span class="sig-paren">(</span><em>B0=3.07e-05</em>, <em>distance=127562740</em>, <em>imagestrength=1</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fields.DoubleDipole" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">rapt.fields._Field</span></code></p>
<p>Field of two Earth dipoles with parallel magnetic moments.</p>
<p>The dipole at x=y=0 represents Earth, and the dipole at x = distance is an
&#8220;image dipole&#8221;, whose field compresses the dipole at origin, simulating
the dayside compression of the magnetosphere.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>B0</strong> : float, optional</p>
<blockquote>
<div><p>Dipole field strength at the equator (1 Re).</p>
</div></blockquote>
<p><strong>distance</strong> : float, optional</p>
<blockquote>
<div><p>The distance between the two dipoles. Default 20 Re.</p>
</div></blockquote>
<p><strong>imagestrength</strong> : float, optional</p>
<blockquote class="last">
<div><p>The relative strength of the image dipole. Must be &gt;=1. Default 1.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="rapt.fields.DoubleDipole.B">
<code class="descname">B</code><span class="sig-paren">(</span><em>tpos</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fields.DoubleDipole.B" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the magnetic field vector of the double-dipole model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>tpos</strong> : array-like</p>
<blockquote>
<div><p>4-element array of time and x,y,z coordinates.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">array</p>
<blockquote class="last">
<div><p>3-element array (Bx, By, Bz)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="rapt.fields.EarthDipole">
<em class="property">class </em><code class="descclassname">rapt.fields.</code><code class="descname">EarthDipole</code><span class="sig-paren">(</span><em>B0=3.07e-05</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fields.EarthDipole" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">rapt.fields._Field</span></code></p>
<p>The class representing the Earth&#8217;s static dipole with zero tilt angle.</p>
<p>Subclasses <cite>_Field</cite>. Overrides <code class="docutils literal"><span class="pre">gradientstepsize</span></code> and <code class="docutils literal"><span class="pre">B()</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>B0</strong> : float, optional</p>
<blockquote class="last">
<div><p>The equatorial field strength at 1 Earth radius.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="rapt.fields.EarthDipole.B">
<code class="descname">B</code><span class="sig-paren">(</span><em>tpos</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fields.EarthDipole.B" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the magnetic field vector of the Earth&#8217;s dipole.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>tpos</strong> : array-like</p>
<blockquote>
<div><p>4-element array of time and x,y,z coordinates.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">array</p>
<blockquote class="last">
<div><p>3-element array (Bx, By, Bz)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="rapt.fields.Grid">
<em class="property">class </em><code class="descclassname">rapt.fields.</code><code class="descname">Grid</code><span class="sig-paren">(</span><em>filelist</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fields.Grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">rapt.fields._Field</span></code></p>
<p>A superclass for using fields sampled on a Cartesian grid.</p>
<p>Extends the <cite>_Field</cite> class.</p>
<p>Not for direct use; should be subclassed. The derived class should override 
the <cite>parsefile</cite>, <cite>E</cite>, and <cite>B</cite> methods.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filelist</strong> : list of str</p>
<blockquote>
<div><p>A list of file names storing the field grid data, one for each time
instant. The list must be ordered with respect to time.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>ValueError</strong></p>
<blockquote class="last">
<div><p>If the requested time or coordinates are out of bounds.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Each file in the given list contains the electric and magnetic field data on
discrete grid points. The details must be handled by the <cite>parsefile</cite> method.
When a new model is implemented, users must override this method using
the details and storage format of the data file they use.</p>
<p>The <cite>parsefile</cite> method must return a dictionary with the following keys:</p>
<ul class="simple">
<li>&#8220;time&#8221; : The time of the data, float.</li>
<li>&#8220;x&#8221; : 1D array of grid x-coordinates</li>
<li>&#8220;y&#8221; : 1D array of grid y-coordinates</li>
<li>&#8220;z&#8221; : 1D array of grid z-coordinates</li>
<li>&#8220;Bx&#8221; : 3D array of Bx values (similarly &#8220;By&#8221;, &#8220;Bz&#8221;)</li>
<li>&#8220;Ex&#8221; : 3D array of Ex values (similarly &#8220;Ey&#8221;, &#8220;Ez&#8221;)</li>
</ul>
<p>In a given <cite>Grid</cite> instance, the grid point coordinates must be the same for
all files in the list. However, uniform spacing is not required.</p>
<p>The interpolated field vectors are accessed with <cite>Egrid</cite> and <cite>Bgrid</cite> methods. The <cite>E</cite> and <cite>B</cite> methods can be overridden for further tweaking; such as adding a dipole component, or handling missing regions using the field symmetry.</p>
<p>The class creates a 4-D linear interpolation for each of the six field components (Ex, Ey, Ez, Bx, By, Bz). Usually each data file is big, and MHD models are evaluated over a long period of time, resulting in many big data files. Loading the entire data set at once could be impossible for users with only several GB of memory. So the <cite>Grid</cite> object loads only the first three files when initialized, and then updates the interpolation as the tracer moves. There is always at most three time points in the interpolator.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Once the field interpolator is updated, it forgets about earlier times. So after a tracer has advanced sufficiently, if we initialize another tracer, we will get a <cite>ValueError</cite> because the time for the new tracer is out of bounds.</p>
</div>
<p>If the list contains only two files, a linear interpolation is done between two time points. Updates are not applicable.</p>
<p>If the input list contains a single file, the field is considered independent of time. The interpolation is only 3-dimensional. The <cite>_time_indep</cite> attribute is set to <code class="docutils literal"><span class="pre">True</span></code>. The methods <cite>Egrid</cite> and <cite>Bgrid</cite> adjust their behavior accordingly.</p>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="rapt.fields.Grid.B">
<code class="descname">B</code><span class="sig-paren">(</span><em>tpos</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fields.Grid.B" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the magnetic field vector.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>tpos</strong> : array-like</p>
<blockquote>
<div><p>4-element array of time and x,y,z coordinates.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">array</p>
<blockquote class="last">
<div><p>3-element array (Bx, By, Bz)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Currently a wrapper around Bgrid. When subclassing, add further processing in this method as needed.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.fields.Grid.Bgrid">
<code class="descname">Bgrid</code><span class="sig-paren">(</span><em>tpos</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fields.Grid.Bgrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the interpolated magnetic field vector.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>tpos</strong> : array-like</p>
<blockquote>
<div><p>4-element vector of time and position x,y,z.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">array</p>
<blockquote class="last">
<div><p>3-element array (Bx,By,Bz) of the magnetic field at the specified time and position.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>When called with time &gt; (t1+t2)/2, where t0,t1,t2 are three time interpolation points,
calls <cite>_update_interpolator</cite>. The interpolation is redone with grids at times t1,t2,t3.</p>
<p>The <cite>B</cite> method is a wrapper around <cite>Bgrid</cite>. If further processing is required, override <cite>B</cite> when subclassing.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.fields.Grid.E">
<code class="descname">E</code><span class="sig-paren">(</span><em>tpos</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fields.Grid.E" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the electric field vector.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>tpos</strong> : array-like</p>
<blockquote>
<div><p>4-element array of time and x,y,z coordinates.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">array</p>
<blockquote class="last">
<div><p>3-element array (Ex, Ey, Ez)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Currently a wrapper around Egrid. When subclassing, add further processing in this method as needed.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.fields.Grid.Egrid">
<code class="descname">Egrid</code><span class="sig-paren">(</span><em>tpos</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fields.Grid.Egrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the interpolated electric field vector.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>tpos</strong> : array-like</p>
<blockquote>
<div><p>4-element vector of time and position x,y,z.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">array</p>
<blockquote class="last">
<div><p>3-element array (Ex,Ey,Ez) of the electric field at the specified time and position.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>When called with time &gt; (t1+t2)/2, where t0,t1,t2 are three time interpolation points,
calls <cite>_update_interpolator</cite>. The interpolation is redone with grids at times t1,t2,t3.</p>
<p>The <cite>E</cite> method is a wrapper around <cite>Egrid</cite>. If further processing is required, override <cite>E</cite> when subclassing.</p>
</dd></dl>

<dl class="method">
<dt id="rapt.fields.Grid.parsefile">
<code class="descname">parsefile</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fields.Grid.parsefile" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse one data file that stores the field data at one time point.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote class="last">
<div><p>The name of the file storing the grid data.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The code of this method depends on the details of how the data is stored. When <a href="#id1"><span class="problematic" id="id2">`</span></a>Grid&#8217; is subclassed, users should override this method as appropriate.</p>
<p>The method should return a dictionary with at least the following keys:</p>
<blockquote>
<div><ul class="simple">
<li>&#8220;time&#8221; : The time of the data, float.</li>
<li>&#8220;x&#8221; : 1D array of grid x-coordinates</li>
<li>&#8220;y&#8221; : 1D array of grid y-coordinates</li>
<li>&#8220;z&#8221; : 1D array of grid z-coordinates</li>
<li>&#8220;Bx&#8221;, &#8220;By&#8221;, &#8220;Bz&#8221; : 3D arrays of Bx, By, Bz values</li>
<li>&#8220;Ex&#8221;, &#8220;Ey&#8221;, &#8220;Ez&#8221; : 3D arrays of Ex, Ey, Ez values</li>
</ul>
</div></blockquote>
<p>All values should be in SI units.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="rapt.fields.Parabolic">
<em class="property">class </em><code class="descclassname">rapt.fields.</code><code class="descname">Parabolic</code><span class="sig-paren">(</span><em>B0=10.0</em>, <em>Bn=1.0</em>, <em>d=0.2</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fields.Parabolic" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">rapt.fields._Field</span></code></p>
<p>The parabolic magnetic field model imitating the current sheet in the 
magnetotail.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>B0</strong> : float, optional</p>
<blockquote>
<div><p>The scale of the x-component of the field. Default 10.</p>
</div></blockquote>
<p><strong>Bn</strong> : float, optional</p>
<blockquote>
<div><p>The z-component of the field. Default 1.</p>
</div></blockquote>
<p><strong>d</strong> : float, optional</p>
<blockquote class="last">
<div><p>The length scale, default 0.2. The field x-component increases by B0
when we move by d in z-direction.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This model has the form :math: <cite>B = (B0 z/d, 0, Bn)</cite> if :math: <cite>|z|&lt;1</cite> and
:math: <cite>B = (B0/d, 0, Bn)</cite> otherwise. The field lines have a parabolic shape.
Particles exhibit Speiser orbits, cucumber orbits and serpentine orbits.</p>
<p>The parabolic model is well suited to testing the <cite>Adaptive</cite> mode because of
the localized nonadiabaticity near z=0.</p>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="rapt.fields.Parabolic.B">
<code class="descname">B</code><span class="sig-paren">(</span><em>tpos</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fields.Parabolic.B" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="rapt.fields.UniformBz">
<em class="property">class </em><code class="descclassname">rapt.fields.</code><code class="descname">UniformBz</code><span class="sig-paren">(</span><em>Bz=1</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fields.UniformBz" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">rapt.fields._Field</span></code></p>
<p>Uniform static magnetic field in the z-direction, B = (0,0,Bz).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>Bz</strong> : float, optional</p>
<blockquote class="last">
<div><p>The constant field strength value in the z-direction. Default 1 T.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="rapt.fields.UniformBz.B">
<code class="descname">B</code><span class="sig-paren">(</span><em>tpos</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fields.UniformBz.B" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the uniform magnetic field vector.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>tpos</strong> : array-like</p>
<blockquote>
<div><p>4-element array of time and x,y,z coordinates.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">array</p>
<blockquote class="last">
<div><p>3-element array (0, 0, Bz)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="rapt.fields.UniformCrossedEB">
<em class="property">class </em><code class="descclassname">rapt.fields.</code><code class="descname">UniformCrossedEB</code><span class="sig-paren">(</span><em>Ey=1</em>, <em>Bz=1</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fields.UniformCrossedEB" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#rapt.fields.UniformBz" title="rapt.fields.UniformBz"><code class="xref py py-class docutils literal"><span class="pre">rapt.fields.UniformBz</span></code></a></p>
<p>Perpendicular uniform static electric and magnetic fields.</p>
<p>E = (0,Ey,0), B = (0,0,Bz)</p>
<p>Extends <cite>UniformBz</cite>. Sets <cite>static</cite> to <code class="docutils literal"><span class="pre">False</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>Ey</strong> : float, optional</p>
<blockquote>
<div><p>The constant electric field value in the y-direction (V/m). Default 1.</p>
</div></blockquote>
<p><strong>Bz</strong> : float, optional</p>
<blockquote class="last">
<div><p>The constant electric field value in th z-direction (T). Default 1.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="rapt.fields.UniformCrossedEB.E">
<code class="descname">E</code><span class="sig-paren">(</span><em>tpos</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fields.UniformCrossedEB.E" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the uniform electric field vector.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>tpos</strong> : array-like</p>
<blockquote>
<div><p>4-element array of time and x,y,z coordinates.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">array</p>
<blockquote class="last">
<div><p>3-element array (0, Ey, 0)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="rapt.fields.VarEarthDipole">
<em class="property">class </em><code class="descclassname">rapt.fields.</code><code class="descname">VarEarthDipole</code><span class="sig-paren">(</span><em>amp=0.1</em>, <em>period=10</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fields.VarEarthDipole" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">rapt.fields._Field</span></code></p>
<p>Time-varying Earth dipole.</p>
<p>The magnetic moment oscillates sinusodially around the nominal value. 
Illustrates time-dependent field setup.</p>
<p>The induced electric field is ignored.</p>
<p>Extends <cite>_Field</cite>. Sets <code class="docutils literal"><span class="pre">static</span></code> to False.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>amp</strong> : float, optional</p>
<blockquote>
<div><p>The relative amplitude of the oscillations. Default 0.1. Unitless.</p>
</div></blockquote>
<p><strong>period</strong> : float, optional</p>
<blockquote class="last">
<div><p>The period of oscillations, in seconds. Default 10.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="rapt.fields.VarEarthDipole.B">
<code class="descname">B</code><span class="sig-paren">(</span><em>tpos</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.fields.VarEarthDipole.B" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the variable Earth dipole magnetic field vector.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>tpos</strong> : array-like</p>
<blockquote>
<div><p>4-element array of time and x,y,z coordinates.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">array</p>
<blockquote class="last">
<div><p>3-element array (Bx, By, Bz) at time t.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-rapt.flutils">
<span id="rapt-flutils-module"></span><h2>rapt.flutils module<a class="headerlink" href="#module-rapt.flutils" title="Permalink to this headline">¶</a></h2>
<p>RAPT field line utility functions</p>
<dl class="docutils">
<dt>AUTHOR:</dt>
<dd><p class="first">Kaan Ozturk &lt;<a class="reference external" href="mailto:mkozturk&#37;&#52;&#48;yahoo&#46;com">mkozturk<span>&#64;</span>yahoo<span>&#46;</span>com</a>&gt;</p>
<p class="last">2016, Rice University</p>
</dd>
</dl>
<dl class="function">
<dt id="rapt.flutils.bounceperiod">
<code class="descclassname">rapt.flutils.</code><code class="descname">bounceperiod</code><span class="sig-paren">(</span><em>tpos</em>, <em>field</em>, <em>Bm</em>, <em>v</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.flutils.bounceperiod" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the bounce period.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>tpos</strong> : array-like</p>
<blockquote>
<div><p>4-element array of time and position.</p>
</div></blockquote>
<p><strong>field: Field object</strong></p>
<blockquote>
<div><p>The field object under which the integral is evaluated.</p>
</div></blockquote>
<p><strong>Bm</strong> : float</p>
<blockquote>
<div><p>Mirror field value (T).</p>
</div></blockquote>
<p><strong>v</strong> : float</p>
<blockquote>
<div><p>Particle speed (m/s).</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float</p>
<blockquote class="last">
<div><p>The bounce period of a particle with the specified conditions.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rapt.flutils.criticalpoints">
<code class="descclassname">rapt.flutils.</code><code class="descname">criticalpoints</code><span class="sig-paren">(</span><em>tpos</em>, <em>field</em>, <em>Bm</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.flutils.criticalpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of critical points where the field strength is a maximum or a minimum along the field line.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>tpos</strong> : array-like</p>
<blockquote>
<div><p>Starting position and time for the field line.</p>
</div></blockquote>
<p><strong>field</strong> : Field</p>
<blockquote>
<div><p>The field object that provides electric and magnetic field vectors and 
related quantities.</p>
</div></blockquote>
<p><strong>Bm</strong> : float</p>
<blockquote>
<div><p>The mirror field strength in Tesla (defines the endpoints of the field line).</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">array</p>
<blockquote class="last">
<div><p>Array of (s, B, B&#8217;&#8216;) triplets for each critical point, where s is the
location along the field line (with respect to the initial position),
B is the field strength at s, and B&#8217;&#8217; is the second derivative along
the field line.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rapt.flutils.eye">
<code class="descclassname">rapt.flutils.</code><code class="descname">eye</code><span class="sig-paren">(</span><em>tpos</em>, <em>field</em>, <em>Bm</em>, <em>usedipole=False</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.flutils.eye" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the I integral (second invariant) value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>tpos</strong> : array-like</p>
<blockquote>
<div><p>4-element vector of time (s) and starting position of the field line
(meters).</p>
</div></blockquote>
<p><strong>Bm</strong> : float</p>
<blockquote>
<div><p>Mirror field value in Tesla.</p>
</div></blockquote>
<p><strong>field: Field object</strong></p>
<blockquote>
<div><p>The field object under which the integral is evaluated.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float</p>
<blockquote>
<div><p>The second invariant I, evaluated over the field line passing through
the starting point at the given time.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body"><p class="first"><strong>usedipole</strong> : bool, optional</p>
<blockquote class="last">
<div><p>If True, uses the formula for dipole, without following a field line.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rapt.flutils.eye_error">
<code class="descclassname">rapt.flutils.</code><code class="descname">eye_error</code><span class="sig-paren">(</span><em>tpos</em>, <em>field</em>, <em>Bm</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.flutils.eye_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the error in I calculated from the field line compared to the
analytic dipole form. For debugging.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>tpos</strong> : array-like</p>
<blockquote>
<div><p>4-element array of time and position.</p>
</div></blockquote>
<p><strong>field: Field object</strong></p>
<blockquote>
<div><p>The field object under which the integral is evaluated.</p>
</div></blockquote>
<p><strong>Bm</strong> : float</p>
<blockquote>
<div><p>Mirror field value (T).</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float</p>
<blockquote class="last">
<div><p>The difference between I values computed over field line and using the
dipole formula.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rapt.flutils.fl_error">
<code class="descclassname">rapt.flutils.</code><code class="descname">fl_error</code><span class="sig-paren">(</span><em>tpos</em>, <em>field</em>, <em>Bm</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.flutils.fl_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the max and mean relative error of calculated dipole field line 
points, compared to the analytic result. For debugging.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>tpos</strong> : array-like</p>
<blockquote>
<div><p>4-element array of time and position.</p>
</div></blockquote>
<p><strong>field: Field object</strong></p>
<blockquote>
<div><p>The field object under which the integral is evaluated.</p>
</div></blockquote>
<p><strong>Bm</strong> : float</p>
<blockquote>
<div><p>Mirror field value (T).</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>e_max</strong> : float</p>
<blockquote>
<div><p>The maximum error</p>
</div></blockquote>
<p><strong>e_avg</strong> : float</p>
<blockquote class="last">
<div><p>Th average error</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rapt.flutils.gradI">
<code class="descclassname">rapt.flutils.</code><code class="descname">gradI</code><span class="sig-paren">(</span><em>tpos</em>, <em>field</em>, <em>Bm</em>, <em>usedipole=False</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.flutils.gradI" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the gradient of the second invariant at the given location.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>tpos</strong> : array-like</p>
<blockquote>
<div><p>4-element vector of time (s) and starting position of the field line
(meters).</p>
</div></blockquote>
<p><strong>field: Field object</strong></p>
<blockquote>
<div><p>The field object under which the integral is evaluated.</p>
</div></blockquote>
<p><strong>Bm</strong> : float</p>
<blockquote>
<div><p>Mirror field value in Tesla.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">array</p>
<blockquote>
<div><p>The gradient vector of the second invariant I.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body"><p class="first"><strong>usedipole</strong> : bool, optional</p>
<blockquote class="last">
<div><p>If True, uses the formula for dipole, without following a field line.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The derivatives are calculated using central differences in two directions
that are perpendicular to the field vector. The step size is set with the
<code class="docutils literal"><span class="pre">rapt.params[&quot;eyegradientstep&quot;]</span></code> parameter. If this value is too small,
grad I becomes to jagged and the <cite>BounceCenter</cite> solver does not converge.</p>
<p>If the particle has a very small bounce amplitude, one of the points in the
central difference may have a field stronger than the mirror field, giving
I = 0. In this case, forward differencing is used.</p>
</dd></dl>

<dl class="function">
<dt id="rapt.flutils.halfbouncepath">
<code class="descclassname">rapt.flutils.</code><code class="descname">halfbouncepath</code><span class="sig-paren">(</span><em>tpos</em>, <em>field</em>, <em>Bm</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.flutils.halfbouncepath" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the half-bounce path length S_b.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>tpos</strong> : array-like</p>
<blockquote>
<div><p>4-element array of time and position.</p>
</div></blockquote>
<p><strong>field: Field object</strong></p>
<blockquote>
<div><p>The field object under which the integral is evaluated.</p>
</div></blockquote>
<p><strong>Bm</strong> : float</p>
<blockquote>
<div><p>Mirror field value (T).</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float</p>
<blockquote class="last">
<div><p>The half-bounce path length (m) : The total helical distance traveled by a 
particle around the guiding line passing through the given location and
mirroring at B=Bm.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-rapt.rcme">
<span id="rapt-rcme-module"></span><h2>rapt.rcme module<a class="headerlink" href="#module-rapt.rcme" title="Permalink to this headline">¶</a></h2>
<p>Created on Mon May  2 11:00:31 2016</p>
<p>&#64;author: kaan</p>
<dl class="class">
<dt id="rapt.rcme.RCME">
<em class="property">class </em><code class="descclassname">rapt.rcme.</code><code class="descname">RCME</code><span class="sig-paren">(</span><em>filelist</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.rcme.RCME" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#rapt.fields.Grid" title="rapt.fields.Grid"><code class="xref py py-class docutils literal"><span class="pre">rapt.fields.Grid</span></code></a></p>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="rapt.rcme.RCME.B">
<code class="descname">B</code><span class="sig-paren">(</span><em>tpos</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.rcme.RCME.B" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="rapt.rcme.RCME.B0">
<code class="descname">B0</code><em class="property"> = 3.0574e-05</em><a class="headerlink" href="#rapt.rcme.RCME.B0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="rapt.rcme.RCME.E">
<code class="descname">E</code><span class="sig-paren">(</span><em>tpos</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.rcme.RCME.E" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="rapt.rcme.RCME.parsefile">
<code class="descname">parsefile</code><span class="sig-paren">(</span><em>fname</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.rcme.RCME.parsefile" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-rapt.rkf">
<span id="rapt-rkf-module"></span><h2>rapt.rkf module<a class="headerlink" href="#module-rapt.rkf" title="Permalink to this headline">¶</a></h2>
<p>Created on Mon Nov  9 11:38:05 2015</p>
<dl class="docutils">
<dt>AUTHOR:</dt>
<dd>Jonathan Senning &lt;<a class="reference external" href="mailto:jonathan&#46;senning&#37;&#52;&#48;gordon&#46;edu">jonathan<span>&#46;</span>senning<span>&#64;</span>gordon<span>&#46;</span>edu</a>&gt;
Gordon College
Based Octave functions written in the spring of 1999
Python version: March 2008, October 2008</dd>
</dl>
<dl class="function">
<dt id="rapt.rkf.rkf">
<code class="descclassname">rapt.rkf.</code><code class="descname">rkf</code><span class="sig-paren">(</span><em>f</em>, <em>a</em>, <em>b</em>, <em>x0</em>, <em>tol</em>, <em>hmax</em>, <em>hmin</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.rkf.rkf" title="Permalink to this definition">¶</a></dt>
<dd><p>Runge-Kutta-Fehlberg method to solve x&#8217; = f(x,t) with x(t[0]) = x0.</p>
<dl class="docutils">
<dt>USAGE:</dt>
<dd>t, x = rkf(f, a, b, x0, tol, hmax, hmin)</dd>
<dt>INPUT:</dt>
<dd>f     - function equal to dx/dt = f(x,t)
a     - left-hand endpoint of interval (initial condition is here)
b     - right-hand endpoint of interval
x0    - initial x value: x0 = x(a)
tol   - maximum value of local truncation error estimate
hmax  - maximum step size
hmin  - minimum step size</dd>
<dt>OUTPUT:</dt>
<dd>t     - NumPy array of independent variable values
x     - NumPy array of corresponding solution function values</dd>
<dt>NOTES:</dt>
<dd>This function implements 4th-5th order Runge-Kutta-Fehlberg Method
to solve the initial value problem</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="rapt-tricubic-module">
<h2>rapt.tricubic module<a class="headerlink" href="#rapt-tricubic-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-rapt.utils">
<span id="rapt-utils-module"></span><h2>rapt.utils module<a class="headerlink" href="#module-rapt.utils" title="Permalink to this headline">¶</a></h2>
<p>RAPT utility functions</p>
<dl class="docutils">
<dt>AUTHOR:</dt>
<dd><p class="first">Kaan Ozturk &lt;<a class="reference external" href="mailto:mkozturk&#37;&#52;&#48;yahoo&#46;com">mkozturk<span>&#64;</span>yahoo<span>&#46;</span>com</a>&gt;</p>
<p class="last">2016, Rice University</p>
</dd>
</dl>
<dl class="function">
<dt id="rapt.utils.Bm">
<code class="descclassname">rapt.utils.</code><code class="descname">Bm</code><span class="sig-paren">(</span><em>tpos</em>, <em>pa</em>, <em>field</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.utils.Bm" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the mirror field for a particle. Assumes conservation of the first invariant.
tpos: [time,x,y,z]
pa: pitch angle in degrees
field: the field object.</p>
</dd></dl>

<dl class="function">
<dt id="rapt.utils.GCtoFP">
<code class="descclassname">rapt.utils.</code><code class="descname">GCtoFP</code><span class="sig-paren">(</span><em>t</em>, <em>R</em>, <em>vp</em>, <em>speed</em>, <em>field</em>, <em>mass</em>, <em>charge</em>, <em>gyrophase=0</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.utils.GCtoFP" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Particle position for the given guiding center position.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>t</strong> : float</p>
<blockquote>
<div><p>The time at which to evaluate the field.</p>
</div></blockquote>
<p><strong>R</strong> : array-like</p>
<blockquote>
<div><p>The guiding-center coordinate vector.</p>
</div></blockquote>
<p><strong>vp</strong> : float</p>
<blockquote>
<div><p>The parallel speed.</p>
</div></blockquote>
<p><strong>speed</strong> : float</p>
<blockquote>
<div><p>The total speed of the particle.</p>
</div></blockquote>
<p><strong>field: Field object</strong></p>
<blockquote>
<div><p>The field object that provides electric and magnetic field vectors and 
related quantities.</p>
</div></blockquote>
<p><strong>mass: float</strong></p>
<blockquote>
<div><p>The mass of the particle, in kg.</p>
</div></blockquote>
<p><strong>charge: float</strong></p>
<blockquote>
<div><p>The charge of the particle, in Coulombs.</p>
</div></blockquote>
<p><strong>gyrophase</strong> : float, optional</p>
<blockquote>
<div><p>The arbitrary cyclotron motion phase, in radians.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pos</strong> : array-like</p>
<blockquote>
<div><p>The position vector of the particle</p>
</div></blockquote>
<p><strong>vel</strong> : array-like</p>
<blockquote class="last">
<div><p>The velocity vector of the particle</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#rapt.utils.getperp" title="rapt.utils.getperp"><code class="xref py py-obj docutils literal"><span class="pre">getperp</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>Determines the particle position by constructing a vector that is
perpendicular to the magnetic field vector at the guiding-center position.
The angle is arbitrary for practical purposes, but deterministic. See the
Notes on the <cite>getperp</cite> function.</p>
<p>The user can set an angle with respect to that fixed direction using the 
<cite>gyrophase</cite> parameter, to experiment with the effects of different phase
angles, if necessary.</p>
</dd></dl>

<dl class="function">
<dt id="rapt.utils.cyclotron_period">
<code class="descclassname">rapt.utils.</code><code class="descname">cyclotron_period</code><span class="sig-paren">(</span><em>t</em>, <em>pos</em>, <em>vel</em>, <em>field</em>, <em>mass</em>, <em>charge</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.utils.cyclotron_period" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Return the period of the cyclotron motion of a particle.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>t</strong> : float</p>
<blockquote>
<div><blockquote>
<div><p>Time (seconds)</p>
</div></blockquote>
<dl class="docutils">
<dt>pos</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">array-like</span><dd><p class="first last">Position array (x,y,z) (meters)</p>
</dd>
<dt>vel</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">array-like</span><dd><p class="first last">Velocity array (vx, vy, vz) (m/s)</p>
</dd>
<dt>field: Field object</dt>
<dd><p class="first last">The field object that provides electric and magnetic field vectors and 
related quantities.</p>
</dd>
<dt>mass: float</dt>
<dd><p class="first last">The mass of the particle, in kg.</p>
</dd>
<dt>charge: float</dt>
<dd><p class="first last">The charge of the particle, in Coulombs.</p>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float</p>
<blockquote>
<div><p>The cyclotron period :math: `</p>
</div></blockquote>
<p class="last">rac{2pigamma m}{qB}`</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Works with the velocity vector. Suitable to use with <cite>Particle</cite> data.</p>
</dd></dl>

<dl class="function">
<dt id="rapt.utils.cyclotron_period2">
<code class="descclassname">rapt.utils.</code><code class="descname">cyclotron_period2</code><span class="sig-paren">(</span><em>t</em>, <em>pos</em>, <em>speed</em>, <em>field</em>, <em>mass</em>, <em>charge</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.utils.cyclotron_period2" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Return the period of the cyclotron motion of a guiding center.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>t</strong> : float</p>
<blockquote>
<div><blockquote>
<div><p>Time (seconds)</p>
</div></blockquote>
<dl class="docutils">
<dt>pos</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">array-like</span><dd><p class="first last">Position array (x,y,z) (meters)</p>
</dd>
<dt>speed</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd><p class="first last">The speed of the particle (m/s)</p>
</dd>
<dt>field: Field object</dt>
<dd><p class="first last">The field object that provides electric and magnetic field vectors and 
related quantities.</p>
</dd>
<dt>mass: float</dt>
<dd><p class="first last">The mass of the particle, in kg.</p>
</dd>
<dt>charge: float</dt>
<dd><p class="first last">The charge of the particle, in Coulombs.</p>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float</p>
<blockquote>
<div><p>The cyclotron period :math: `</p>
</div></blockquote>
<p class="last">rac{2pigamma m}{qB}`</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Works with the total speed. Suitable to call with <cite>GuidingCenter</cite> data.</p>
</dd></dl>

<dl class="function">
<dt id="rapt.utils.cyclotron_radius">
<code class="descclassname">rapt.utils.</code><code class="descname">cyclotron_radius</code><span class="sig-paren">(</span><em>t</em>, <em>pos</em>, <em>vel</em>, <em>field</em>, <em>mass</em>, <em>charge</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.utils.cyclotron_radius" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Return the radius of the cyclotron motion of a particle.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>t</strong> : float</p>
<blockquote>
<div><blockquote>
<div><p>Time (seconds)</p>
</div></blockquote>
<dl class="docutils">
<dt>pos</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">array-like</span><dd><p class="first last">Position array (x,y,z) (meters)</p>
</dd>
<dt>vel</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">array-like</span><dd><p class="first last">Velocity array (vx, vy, vz) (m/s)</p>
</dd>
<dt>field: Field object</dt>
<dd><p class="first last">The field object that provides electric and magnetic field vectors and 
related quantities.</p>
</dd>
<dt>mass: float</dt>
<dd><p class="first last">The mass of the particle, in kg.</p>
</dd>
<dt>charge: float</dt>
<dd><p class="first last">The charge of the particle, in Coulombs.</p>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float</p>
<blockquote>
<div><p>The cyclotron radius :math: `</p>
</div></blockquote>
<p class="last">rac{gamma m <a href="#id3"><span class="problematic" id="id4">v_</span></a>perp}{qB}`</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Works with the velocity vector. Suitable to use with <cite>Particle</cite> data.</p>
</dd></dl>

<dl class="function">
<dt id="rapt.utils.cyclotron_radius2">
<code class="descclassname">rapt.utils.</code><code class="descname">cyclotron_radius2</code><span class="sig-paren">(</span><em>t</em>, <em>pos</em>, <em>vpar</em>, <em>v</em>, <em>field</em>, <em>mass</em>, <em>charge</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.utils.cyclotron_radius2" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Return the radius of the cyclotron motion of a particle.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>t</strong> : float</p>
<blockquote>
<div><blockquote>
<div><p>Time (seconds)</p>
</div></blockquote>
<dl class="docutils">
<dt>pos</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">array-like</span><dd><p class="first last">Position array (x,y,z) (meters)</p>
</dd>
<dt>vpar</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd><p class="first last">Parallel speed (m/s)</p>
</dd>
<dt>v</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd><p class="first last">Total speed (m/s)</p>
</dd>
<dt>field: Field object</dt>
<dd><p class="first last">The field object that provides electric and magnetic field vectors and 
related quantities.</p>
</dd>
<dt>mass: float</dt>
<dd><p class="first last">The mass of the particle, in kg.</p>
</dd>
<dt>charge: float</dt>
<dd><p class="first last">The charge of the particle, in Coulombs.</p>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float</p>
<blockquote>
<div><p>The cyclotron radius :math: `</p>
</div></blockquote>
<p class="last">rac{gamma m <a href="#id5"><span class="problematic" id="id6">v_</span></a>perp}{qB}`</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Works with the total speed and the parallel speed. Suitable to call with 
<cite>GuidingCenter</cite> data.</p>
</dd></dl>

<dl class="function">
<dt id="rapt.utils.dipoleBm">
<code class="descclassname">rapt.utils.</code><code class="descname">dipoleBm</code><span class="sig-paren">(</span><em>L</em>, <em>eqpa</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.utils.dipoleBm" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the mirror field for a particle in dipole field. Assumes conservation of the first invariant.
L: Equatorial distance in Re.
eqpa: Equatorial pitch angle.</p>
</dd></dl>

<dl class="function">
<dt id="rapt.utils.dipoleI">
<code class="descclassname">rapt.utils.</code><code class="descname">dipoleI</code><span class="sig-paren">(</span><em>R0</em>, <em>Bm</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.utils.dipoleI" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the second invariant value in dipole field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>R0</strong> : float</p>
<blockquote>
<div><p>Equatorial distance to the guiding line (meters)</p>
</div></blockquote>
<p><strong>Bm</strong> : float</p>
<blockquote>
<div><p>Mirror field strength. (Tesla)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float</p>
<blockquote class="last">
<div><p>The second invariant :math: <cite>I = int_{s_{m1}}^{s_{m2}sqrt{1 - B(s)/B_m}ds</cite></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rapt.utils.dipole_bounce_period">
<code class="descclassname">rapt.utils.</code><code class="descname">dipole_bounce_period</code><span class="sig-paren">(</span><em>L</em>, <em>v</em>, <em>eqpa</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.utils.dipole_bounce_period" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the approximate bounce period of a particle in dipole field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>L</strong> : float</p>
<blockquote>
<div><p>Initial equatorial distance in units of Re.</p>
</div></blockquote>
<p><strong>v: float</strong></p>
<blockquote>
<div><p>Particle speed.</p>
</div></blockquote>
<p><strong>eqpa</strong> : float</p>
<blockquote>
<div><p>Equatorial pitch angle in degrees.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float</p>
<blockquote class="last">
<div><p>The bounce period of a particle (proton or electron) under dipole.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Martin Walt, &#8216;Introduction to Geomagnetically Trapped Radiation&#8217;, p.49</p>
</dd></dl>

<dl class="function">
<dt id="rapt.utils.dipole_drift_period_e">
<code class="descclassname">rapt.utils.</code><code class="descname">dipole_drift_period_e</code><span class="sig-paren">(</span><em>L</em>, <em>v</em>, <em>eqpa</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.utils.dipole_drift_period_e" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the approximate drift period of a electron in dipole field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>L</strong> : float</p>
<blockquote>
<div><p>Initial equatorial distance in units of Re.</p>
</div></blockquote>
<p><strong>v: float</strong></p>
<blockquote>
<div><p>Particle speed.</p>
</div></blockquote>
<p><strong>eqpa</strong> : float</p>
<blockquote>
<div><p>Equatorial pitch angle in degrees.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float</p>
<blockquote class="last">
<div><p>The drift period of a electron under the dipole field.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Martin Walt, &#8216;Introduction to Geomagnetically Trapped Radiation&#8217;, p.49</p>
</dd></dl>

<dl class="function">
<dt id="rapt.utils.dipole_drift_period_p">
<code class="descclassname">rapt.utils.</code><code class="descname">dipole_drift_period_p</code><span class="sig-paren">(</span><em>L</em>, <em>v</em>, <em>eqpa</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.utils.dipole_drift_period_p" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the approximate drift period of a proton in dipole field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>L</strong> : float</p>
<blockquote>
<div><p>Initial equatorial distance in units of Re.</p>
</div></blockquote>
<p><strong>v: float</strong></p>
<blockquote>
<div><p>Particle speed.</p>
</div></blockquote>
<p><strong>eqpa</strong> : float</p>
<blockquote>
<div><p>Equatorial pitch angle in degrees.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float</p>
<blockquote class="last">
<div><p>The drift period of a proton under the dipole field.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Martin Walt, &#8216;Introduction to Geomagnetically Trapped Radiation&#8217;, p.49</p>
</dd></dl>

<dl class="function">
<dt id="rapt.utils.dipole_gradI">
<code class="descclassname">rapt.utils.</code><code class="descname">dipole_gradI</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>Bm</em>, <em>h</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.utils.dipole_gradI" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the gradient of the second invariant in dipole field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x,y</strong> : float</p>
<blockquote>
<div><p>Equatorial position coordinates (meters)</p>
</div></blockquote>
<p><strong>Bm</strong> : float</p>
<blockquote>
<div><p>Mirror field strength. (Tesla)</p>
</div></blockquote>
<p><strong>h</strong> : float</p>
<blockquote>
<div><p>Step size for numerical differencing</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">array</p>
<blockquote class="last">
<div><p>The gradient of the second invariant.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rapt.utils.drift_error">
<code class="descclassname">rapt.utils.</code><code class="descname">drift_error</code><span class="sig-paren">(</span><em>b</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.utils.drift_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a vector of relative error of the bounce-averaged drift path
compared to a circle (the expected drift path under a dipole)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>b</strong> : BounceCenter object</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">array</p>
<blockquote class="last">
<div><p>Array of relative error values at each trajectory point.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rapt.utils.gamma">
<code class="descclassname">rapt.utils.</code><code class="descname">gamma</code><span class="sig-paren">(</span><em>mass=0</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.utils.gamma" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the relativistic factor for given velocity or momentum.</p>
<p>Usage: gamma(velocity=[1,1,2]), or gamma(momentum=[5,5,10], mass=5).</p>
</dd></dl>

<dl class="function">
<dt id="rapt.utils.getperp">
<code class="descclassname">rapt.utils.</code><code class="descname">getperp</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.utils.getperp" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a unit vector perpendicular to v.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>v</strong> : array-like</p>
<blockquote>
<div><p>The reference vector in 3d-space.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">array</p>
<blockquote>
<div><p>A vector perpendicular to the given parameter.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>ValueError</strong></p>
<blockquote class="last">
<div><p>If the input vector is zero.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>There are infinitely many vectors (a,b,c), perpendicular to a given vector 
(x,y,z), satisfying :math: <cite>a x + b y + c z = 0</cite>. Here, the choices are as 
follows:</p>
<blockquote>
<div><ul class="simple">
<li>if x == 0, return [1,0,0]</li>
<li>else if y == 0, return [0,1,0]</li>
<li>else if z == 0, return [0,0,1]</li>
<li>else return [1, 1, -(x+y)/z] (arbitrarily set a=b=1)</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="rapt.utils.guidingcenter">
<code class="descclassname">rapt.utils.</code><code class="descname">guidingcenter</code><span class="sig-paren">(</span><em>t</em>, <em>r</em>, <em>v</em>, <em>field</em>, <em>mass</em>, <em>charge</em>, <em>tol=0.001</em>, <em>maxiter=20</em>, <em>debug=False</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.utils.guidingcenter" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Return the guiding center for the given particle state.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>t</strong> : float</p>
<blockquote>
<div><blockquote>
<div><p>Time (seconds)</p>
</div></blockquote>
<dl class="docutils">
<dt>r</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">array-like</span><dd><p class="first last">Position array (x,y,z) (meters)</p>
</dd>
<dt>v</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">array-like</span><dd><p class="first last">Velocity array (vx, vy, vz) (m/s)</p>
</dd>
<dt>field: Field object</dt>
<dd><p class="first last">The field object that provides electric and magnetic field vectors and 
related quantities.</p>
</dd>
<dt>mass: float</dt>
<dd><p class="first last">The mass of the particle, in kg.</p>
</dd>
<dt>charge: float</dt>
<dd><p class="first last">The charge of the particle, in Coulombs.</p>
</dd>
<dt>tol</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span><dd><p class="first last">The error tolerance (relative change in the last iteration).</p>
</dd>
<dt>maxiter</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span><dd><p class="first last">Maximum number of iterations.</p>
</dd>
<dt>debug</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd><p class="first last">If True, list of intermediate iteration positions is returned.</p>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">array</p>
<blockquote class="last">
<div><blockquote>
<div><p>Position (x,y,z) of the guiding center.</p>
</div></blockquote>
<dl class="docutils">
<dt>float</dt>
<dd><p class="first last">Parallel speed</p>
</dd>
<dt>float</dt>
<dd><p class="first last">Total speed</p>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>ho(R)`. This function solves this vector</dt>
<dd><p class="first">equation iteratively for R.</p>
<p class="last">This equation is actually a truncation of the series at first order, so the
result will not be exactly equal to the actual guiding center, even if the 
tolerance is set to small values. A more accurate expression is available,
but given other error sources, that level of accuracy is not needed.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rapt.utils.magnetic_moment">
<code class="descclassname">rapt.utils.</code><code class="descname">magnetic_moment</code><span class="sig-paren">(</span><em>t</em>, <em>pos</em>, <em>vpar</em>, <em>v</em>, <em>field</em>, <em>mass</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.utils.magnetic_moment" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the magnetic moment of the given guiding center.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>t</strong> : float</p>
<blockquote>
<div><blockquote>
<div><p>Time (seconds)</p>
</div></blockquote>
<dl class="docutils">
<dt>pos</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">array-like</span><dd><p class="first last">Position array (x,y,z) (meters)</p>
</dd>
<dt>vpar</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd><p class="first last">Parallel speed (m/s)</p>
</dd>
<dt>v</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd><p class="first last">Total speed (m/s)</p>
</dd>
<dt>field: Field object</dt>
<dd><p class="first last">The field object that provides electric and magnetic field vectors and 
related quantities.</p>
</dd>
<dt>mass: float</dt>
<dd><p class="first last">The mass of the particle, in kg.</p>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float</p>
<blockquote>
<div><p>The magnetic moment :math: `</p>
</div></blockquote>
<p class="last">rac{gamma^2 m <a href="#id7"><span class="problematic" id="id8">v_</span></a>perp^2}{2B}`</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="rapt.utils.speedfromKE">
<code class="descclassname">rapt.utils.</code><code class="descname">speedfromKE</code><span class="sig-paren">(</span><em>KE</em>, <em>mass</em>, <em>unit='ev'</em><span class="sig-paren">)</span><a class="headerlink" href="#rapt.utils.speedfromKE" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the speed of a particle with given relativistic kinetic energy and mass.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>KE</strong> : float</p>
<blockquote>
<div><p>The kinetic energy of the particle.</p>
</div></blockquote>
<p><strong>mass</strong> : float</p>
<blockquote>
<div><p>The mass of the particle (kg).</p>
</div></blockquote>
<p><strong>unit</strong> : str (optional)</p>
<blockquote>
<div><p>The unit of the energy. If &#8220;ev&#8221; (default), energy is in electron volts,
otherwise in Joules</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float</p>
<blockquote class="last">
<div><p>The speed (m/s) corresponding to the given kinetic energy.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If the energy is less than a millionth of the rest energy (:math: <cite>mc^2</cite>),
uses the nonrelativistic formula :math: <cite>K=mv^2/2</cite>; otherwise uses the
relativistic formula <cite>K = (gamma - 1)mc^2</cite></p>
</dd></dl>

</div>
<div class="section" id="module-rapt">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-rapt" title="Permalink to this headline">¶</a></h2>
<p>This is the docstring for rapt/__init__.py</p>
<dl class="exception">
<dt id="rapt.Adiabatic">
<em class="property">exception </em><code class="descclassname">rapt.</code><code class="descname">Adiabatic</code><a class="headerlink" href="#rapt.Adiabatic" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">Exception</span></code></p>
</dd></dl>

<dl class="exception">
<dt id="rapt.NonAdiabatic">
<em class="property">exception </em><code class="descclassname">rapt.</code><code class="descname">NonAdiabatic</code><a class="headerlink" href="#rapt.NonAdiabatic" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">Exception</span></code></p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">rapt 0.9 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, Kaan Ozturk.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1.
    </div>
  </body>
</html>